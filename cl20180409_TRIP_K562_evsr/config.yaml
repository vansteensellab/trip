# Configuration file for mapping of Thetered-TRIP experiments performed in K562 cells.
# This configuration contains all configurations used by the pipeline.
# Different parts of the pipeline use this configuration:
#
# snakemake:
#   this part mainly contains input files and a description of each file
#   the following input files are used:
#     - cDNA:
#         fastq files with cDNA reads of barcoded reporters
#     - gDNA:
#         fastq files with gDNA reads of barcoded reporters used to normalize the cDNA (cDNA) reads
#     - spike-in:
#         fastq file with only reads of the spike-in library which was mixed in with the cDNA and gDNA reads.
#     - forward_mapping:
#         fastq files with forward iPCR reads of reporter integrations containing barcodes.
#     - reverse_mapping:
#         fastq files with reverse iPCR reads of reporter integrations with intergration site.

###############################
### snakemake configuration ###
###############################
outdir: '/DATA/usr/c.leemans/projects/trip/cl20180409_TRIP_K562_evsr'



###############################################################################
###++++++++++++++++++++++++++++ parser settings ++++++++++++++++++++++++++++###
###############################################################################
# Typical structure of gDNA and cDNA reads:
#      index            pat1               barcode           pat2
# NNNNNNNNNNGTCACAAGGGCCGGCCACAACTCGAGNNNNNNNNNNNNNNNNTGATCCTGCAGTGTCACC...
#
# settings:
#   barcode_length -- the length of the barcode
#   pat1 -- the first constant pattern (after index, before barcode)
#   pat2 -- the pattern after the barcode
# #****************************************************************************
# Typical structures of mapping reads
#
# Forward Read:
#
# format_map1
#      index   	        pat1             barcode     pat2		genomic DNA
# NNNNNNNNNNGTCACAAGGGCCGGCCACAACTCGAGNNNNNNNNNNNNNNNNTGATCNNNNNNNNNNNNNNNNNNNN
#
# Reverse Read:
# 	     map_pat_rev					     genomic DNA
# GTACGTCACAATATGATTATCTTTCTAGGGTTAANNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN

indir:
    /DATA/usr/c.leemans/data/forge/userdata/yx4x9aCqK2TJCuwR8UgDsLwcMORpOIiZ62uONIgQ

input_file:
    options:
        mapping1: [M403/4687_1_BarcodedPool_NoIndex_S1_R1_001.fastq.gz,
                   M403/4687_1_BarcodedPool_NoIndex_S1_R2_001.fastq.gz]
        mapping2: [run775/4732_1_BarcodedPool_NoIndex_S1_R1_001.fastq.gz,
                   run775/4732_1_BarcodedPool_NoIndex_S1_R2_001.fastq.gz]
        gcDNA1: [run766/4688_1_BarcodedPool_NoIndex_S2_R1_001.fastq.gz]
        gcDNA2: [M411/4751_1_BarcodedPool_NoIndex_S1_R1_001.fastq.gz]
    pick:
        mapping:
            '6':
                A: [mapping1, mapping2]
                B: [mapping1, mapping2]
            '8':
                A: [mapping1, mapping2]
                B: [mapping1, mapping2]
            '11':
                A: [mapping1, mapping2]
                B: [mapping1, mapping2]
            hPGK:
                A: [mapping1, mapping2]
                B: [mapping1, mapping2]
        cDNA:
            '6':
                A: [gcDNA1, gcDNA1]
                B: [gcDNA1, gcDNA1]
            '8':
                A: [gcDNA1, gcDNA1]
                B: [gcDNA1, gcDNA1]
            '11':
                A: [gcDNA1, gcDNA1]
                B: [gcDNA1, gcDNA1]
            hPGK:
                A: [gcDNA1, gcDNA1]
                B: [gcDNA1, gcDNA1]
        gDNA:
            '6':
                A: [gcDNA1, gcDNA1]
                B: [gcDNA1, gcDNA1]
            '8':
                A: [gcDNA1, gcDNA1]
                B: [gcDNA1, gcDNA1]
            '11':
                A: [gcDNA1, gcDNA1]
                B: [gcDNA1, gcDNA1]
            hPGK:
                A: [gcDNA1, gcDNA1]
                B: [gcDNA1, gcDNA1]

index:
    mapping:
        '6':
            A: [TAGTATCAGC, ACGAGTGCGT]
            B: [TCTCTATGCG, ACGCTCGACA]
        '8':
            A: [TGATACGTCT, AGACGCACTC]
            B: [TACTGAGCTA, AGCACTGTAG]
        '11':
            A: [CATAGTAGTG, ATCAGACACG]
            B: [CGAGAGATAC, ATATCGCGAG]
        hPGK:
            A: [ATACGACGTA, CGTGTCTCTA]
            B: [TCACGTACTA, CTCGCGTGTC]
    gDNA:
        '6':
            A: [TCGTCGCTCG, TAGTGTAGAT]
            B: [ACATACGCGT, TCGATCACGT]
        '8':
            A: [ACGCGAGTAT, TCGCACTAGT]
            B: [ACTACTATGT, TCTAGCGACT]
        '11':
            A: [ACTGTACAGT, TCTATACTAT]
            B: [AGACTATACT, TGACGTATGT]
        hPGK:
            A: [AGCGTCGTCT, TGTGAGTAGT]
            B: [AGTACGCTAT, ACAGTATATA]
    cDNA:
        '6':
            A: [ATAGAGTACT, ACGAGTGCGT]
            B: [CACGCTACGT, ACGCTCGACA]
        '8':
            A: [CAGTAGACGT, AGACGCACTC]
            B: [CGACGTGACT, AGCACTGTAG]
        '11':
            A: [TACACACACT, ATCAGACACG]
            B: [TACACGTGAT, ATATCGCGAG]
        hPGK:
            A: [TACAGATCGT, CGTGTCTCTA]
            B: [TACGCTGTCT, CTCGCGTGTC]


demultiplexed_indir: /DATA/usr/c.leemans/data/forge/yx4x9aCqK2TJCuwR8UgDsLwcMORpOIiZ62uONIgQ

demultiplexed_input:
    mapping:
        '10':
            A:
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_10A_r1_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_10A_r1_R2.fq.gz]
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_10A_r2_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_10A_r2_R2.fq.gz]
            B:
               - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_10B_r1_R1.fq.gz,
                  run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_10B_r1_R2.fq.gz]
               - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_10B_r2_R1.fq.gz,
                  run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_10B_r2_R2.fq.gz]
        '12':
            A:
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_12A_r1_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_12A_r1_R2.fq.gz]
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_12A_r2_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_12A_r2_R2.fq.gz]
            B:
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_12B_r1_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_12B_r1_R2.fq.gz]
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_12B_r2_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_12B_r2_R2.fq.gz]
        '9':
            A:
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_9A_r1_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_9A_r1_R2.fq.gz]
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_9A_r2_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_9A_r2_R2.fq.gz]
            B:
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_9B_r1_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_9B_r1_R2.fq.gz]
                - [run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_9B_r2_R1.fq.gz,
                   run821/4906_1_BarcodedPool_ATCTCGTA_iPCR_9B_r2_R2.fq.gz]
    cDNA:
        '10':
            A:
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_10A_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_10A_r2.fq.gz
            B:
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_10B_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_10B_r2.fq.gz
        '12':
            A:
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_12A_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_12A_r2.fq.gz
            B:
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_12B_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_12B_r2.fq.gz
        '9':
            A:
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_9A_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_9A_r2.fq.gz
            B:
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_9B_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_cDNA_9B_r2.fq.gz
    gDNA:
        '10':
            A:
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_10A_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_10A_r2.fq.gz
            B:
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_10B_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_10B_r2.fq.gz
        '12':
            A:
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_12A_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_12A_r2.fq.gz
            B:
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_12B_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_12B_r2.fq.gz
        '9':
            A:
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_9A_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_9A_r2.fq.gz
            B:
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_9B_r1.fq.gz
                - run823/4879_1_BarcodedPool_NoIndex_gDNA_9B_r2.fq.gz




lev_dist: 2

min_count:
  spike: 1000
  gDNA: 5
  cDNA: 0
  map: 3



starcode_params:
    options:
        mapping1:
            lev_dist: 1
            use_other: True
            other: gDNA
            count: 3
        mapping2:
            lev_dist: 2
            use_other: True
            other: mapping
            count: 3
        gDNA:
            lev_dist: 2
            use_other: True
            other: gDNA
            count: 5
        cDNA:
            lev_dist: 2
            use_other: True
            other: gDNA
            count: 0
    pick:
        mapping:
            '6':
                A: [mapping1, mapping1]
                B: [mapping1, mapping1]
            '9':
                A: [mapping1, mapping1]
                B: [mapping1, mapping1]
            '12':
                A: [mapping1, mapping1]
                B: [mapping1, mapping1]
            '8':
                A: [mapping1, mapping1]
                B: [mapping1, mapping1]
            '10':
                A: [mapping1, mapping1]
                B: [mapping1, mapping1]
            '11':
                A: [mapping1, mapping1]
                B: [mapping1, mapping1]
            hPGK:
                A: [mapping1, mapping1]
                B: [mapping1, mapping1]
        cDNA:
            '6':
                A: [cDNA, cDNA]
                B: [cDNA, cDNA]
            '8':
                A: [cDNA, cDNA]
                B: [cDNA, cDNA]
            '9':
                A: [cDNA, cDNA]
                B: [cDNA, cDNA]
            '10':
                A: [cDNA, cDNA]
                B: [cDNA, cDNA]
            '11':
                A: [cDNA, cDNA]
                B: [cDNA, cDNA]
            '12':
                A: [cDNA, cDNA]
                B: [cDNA, cDNA]
            hPGK:
                A: [cDNA, cDNA]
                B: [cDNA, cDNA]
        gDNA:
            '6':
                A: [gDNA, gDNA]
                B: [gDNA, gDNA]
            '8':
                A: [gDNA, gDNA]
                B: [gDNA, gDNA]
            '9':
                A: [gDNA, gDNA]
                B: [gDNA, gDNA]
            '10':
                A: [gDNA, gDNA]
                B: [gDNA, gDNA]
            '11':
                A: [gDNA, gDNA]
                B: [gDNA, gDNA]
            '12':
                A: [gDNA, gDNA]
                B: [gDNA, gDNA]
            hPGK:
                A: [gDNA, gDNA]
                B: [gDNA, gDNA]


structure:
    options:
        index: |
            ID      5'      3'      type    req     second-read     pos   keep-bases
            index   %s      -       index   present False   fixed   -
        mapping1: |
            ID      5'      3'      type    req     second-read     pos   keep-bases
            map_pat1a       GTCACAAGGGCCGGCCACAAC   -       const   present False   fixed   -
            const_bar       TCGAG\{16\}TGATC  -       const_bar       present False   fixed   -
            rev_map_complement      -       TTAACCCTAGAAAGATAATCATATTGTGACGTAC      const   -       False   var   -
            rev_map GTACGTCACAATATGATTATCTTTCTAGGGTTAA      -       const   present True    fixed   -
            fwd_map_complement      -       GATCA[BC]CTCGAGTTGTGGCCGGCCCTTGTGAC     const_bar_comp  -       True    var   -
        mapping2: |
            ID      5'      3'      type    req     second-read     pos   keep-bases
            index   10      -       const   present False  fixed -
            map_pat1a       GTCACAAGGGCCGGCCACAAC   -       const   present False   fixed   -
            const_bar       TCGAG\{16\}TGATC  -       const_bar       present False   fixed   -
            rev_map_complement      -       TTAACCCTAGAAAGATAATCATATTGTGACGTAC      const   -       False   var   -
            rev_map GTACGTCACAATATGATTATCTTTCTAGGGTTAA      -       const   present True    fixed   -
            fwd_map_complement      -       GATCA[BC]CTCGAGTTGTGGCCGGCCCTTGTGAC     const_bar_comp  -       True    var   -
        gcDNA1: |
            ID      5'      3'      type    req     second-read     pos                   keep-bases
            pat1    GTCACAAGGGCCGGCCACAACTCGAG      -       const   present False   fixed   -
            barcode 16      -       barcode present False   fixed   -
            pat2    TGATCCTGCAGTG   -       const   present False   var   -
        gcDNA2: |
            ID      5'      3'      type    req     second-read     pos                   keep-bases
            index   10      -       const   present False  fixed -
            pat1    GTCACAAGGGCCGGCCACAACTCGAG      -       const   present False   fixed   -
            barcode 16      -       barcode present False   fixed   -
            pat2    TGATCCTGCAGTG   -       const   present False   var   -
    pick:
        mapping:
            '6': mapping1
            '8': mapping1
            '9': mapping2
            '10': mapping2
            '11': mapping1
            '12': mapping2
            hPGK: mapping1
        cDNA:
            '6': gcDNA1
            '8': gcDNA1
            '9': gcDNA2
            '10': gcDNA2
            '11': gcDNA1
            '12': gcDNA2
            hPGK: gcDNA1
        gDNA:
            '6': gcDNA1
            '8': gcDNA1
            '9': gcDNA2
            '10': gcDNA2
            '11': gcDNA1
            '12': gcDNA2
            hPGK: gcDNA1
paired_end:
    mapping: True
    cDNA: False
    gDNA: False


bowtie:
  index: /DATA/usr/c.leemans/data/hg38/hg38_1-22_XYM
  options:
      '1': ['--very-sensitive']
      '2': ['--very-sensitive-local']


max_dist:
    '1': 500
    '2': 20

parser: ~t.v.schaik/mydata/modules/read-parsing/read_parser.py


annotation:
    calls:
        LMNB1:
            - HMM/bin-5kb/K562_LMNB1-5kb-combined_AD.bed.gz
        4xAP3:
            - HMM/bin-5kb/K562_4xAP3-5kb-combined_AD.bed.gz
        CENPB:
            - HMM/bin-5kb/K562_CENPB-5kb-combined_AD.bed.gz
    DAM:
        LMNB1:
            experiment:
                - counts/bin-gatc/K562_r1_LMNB1-gatc
                - counts/bin-gatc/K562_r2_LMNB1-gatc
            control:
                - counts/bin-gatc/K562_r1_Dam16-gatc
                - counts/bin-gatc/K562_r2_Dam10_1-gatc
        4xAP3:
            experiment:
                - counts/bin-gatc/K562_r1_4xAP3-gatc
                - counts/bin-gatc/K562_r2_4xAP3-gatc
            control:
                - counts/bin-gatc/K562_r1_Dam256-gatc
                - counts/bin-gatc/K562_r2_Dam10_2-gatc
        CENPB:
            experiment:
                - counts/bin-gatc/K562_r2_CENPB-gatc
                - counts/bin-gatc/K562_r3_CENPB-gatc
            control:
                - counts/bin-gatc/K562_r2_Dam100-gatc
                - counts/bin-gatc/K562_r3_Dam100-gatc
    hic_compaction:
        indices:
            /home/t.v.schaik/mydata/data/4DNucleome/GRCh38/K562/HiC/GENOVA/K562_5kb.bed
        max_dist:
            [25000, 50000, 100000, 250000]
        signal:
            /home/t.v.schaik/mydata/data/4DNucleome/GRCh38/K562/HiC/GENOVA/K562_5kb.sig
        window:
            [100000, 500000, 1000000]
    sure:
        r1_plus: SuRE23_hg38_K562_B1.cov.plus.bw
        r1_minus: SuRE23_hg38_K562_B1.cov.minus.bw
        r2_plus: SuRE23_hg38_K562_B2.cov.plus.bw
        r2_minus: SuRE23_hg38_K562_B2.cov.minus.bw
    chip: True
    chip_peaks: False
    chip_domains: True

sure_dir: /DATA/usr/c.leemans/data/tracks/hg38
dam_dir: /DATA/usr/t.v.schaik/proj/3D_nucleus/results/ts180110_4DN_DataProcessing/results

signal_window: [5000]
dam_window: [10000]


lad_count: /DATA/usr/c.leemans/projects/lad_atlas/cl20180424_all_lad_regions.bed

genome: hg38

celltype: 'K562'

chip_dir:
    '/DATA/usr/c.leemans/projects/chip_snake/'


chip_config:
    '/DATA/usr/c.leemans/projects/chip_snake/coverage_config_blank.yaml'
chip_snake:
    '/DATA/usr/c.leemans/projects/chip_snake/chip_coverage.snakemake'
